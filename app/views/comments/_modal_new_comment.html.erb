<div class="bs-component">
  <div class="modal fade" id="modal_new_comment">
    <div class="modal-dialog">
      <div class="modal-content">

        <% @comment = Comment.new %>
        <% @comment.owner = @proxy %>

        <%= form_for(@comment, url: "/#{@topic.permalink}/comments", :html => { class: "form-horizontal" }) do |f| %>

          <fieldset>

            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h4>評論『<%= @topic.name %>』</h4>
              <p class="text-muted"><%= @topic.description %></p>
              <p>身份：<strong class="text-primary"><%= @proxy.display_name %></strong></p>
            </div>
            
            <div class="modal-body">

            <% unless @topic.topic_type == :open %>
            <div class="form-group">
              <label for="permalink" class="col-sm-2 control-label">立場</label>
              <div class="col-sm-10">
                <input class="form-control" id="comment_stance" name="comment[stance]" placeholder="立場" type="hidden" value="">
                <button id="button_like" onClick="click_like()" type="button" class="btn btn-success" value="1"><i class="fa fa-check" id="like_check"></i> 支持</button>
                <button id="button_dislike" onClick="click_dislike()" type="button" class="btn btn-danger" value="3"><i class="fa fa-check" id="dislike_check"></i> 反對</button>
                <span class="help-block">這則評論對議題的立場，必要</span>
              </div>
            </div>
            <script type="text/javascript">
              $(function() {
                $("#like_check").hide();
                $("#dislike_check").hide();
                $("#btn_new_comment_spin").hide();
              });
              function click_like(){
                // clear_buttons();
                $("#like_check").show();
                $("#dislike_check").hide();
                $("#comment_stance").val(1);
              }
              function click_dislike(){
                // clear_buttons();
                $("#like_check").hide();
                $("#dislike_check").show();
                $("#comment_stance").val(3);
              }
            </script>
            <% end %>

            <div class="form-group">
              <label for="description" class="col-sm-2 control-label">內容</label>
              <div class="col-sm-10">
                <%= f.text_area :body, class: "form-control", placeholder: "評論內容", rows: "5" %>
                <span class="help-block">必要</span>
              </div>
            </div>

            <div class="form-group">
              <label for="name" class="col-sm-2 control-label">摘要</label>
              <div class="col-sm-10">
                <%= f.text_field :subject, class: "form-control", placeholder: "評論摘要" %>
                <span class="help-block">非必要，最多二十個字</span>
              </div>
            </div>
            
            </div>

            <div class="modal-footer">
            <div class="form-group">
              <div class="col-lg-10 col-lg-offset-2">
                <span class="btn btn-primary" disabled id="btn_new_comment_spin"><i class="fa fa-spinner fa-spin"></i> </span>
                <%= f.submit "送出", :class => 'btn btn-primary', :id => "btn_new_comment"%>
                <button href="#" data-dismiss="modal" class="btn btn-default">返回</button>
              </div>
            </div>
            </div>

            <script type="text/javascript">
              $("#btn_new_comment").click(function() {
                $("#btn_new_comment").hide();
                $("#btn_new_comment_spin").show();
              });
            </script>

          </fieldset>
        <% end %>

      </div>
    </div>
  </div>
</div>